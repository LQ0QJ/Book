{% extends "layouts/index.html" %}

{% block title %}{{ gettext('page.donate.title') }}{% endblock %}

{% block body %}
  {% from 'macros/copy_button.html' import copy_button %}

  {% if has_made_donations %}
    <div class="mb-4 p-6 overflow-hidden bg-[#0000000d] break-words rounded">
      {% if existing_unpaid_donation_id %}
        <div class="mb-4">{{ gettext('page.donate.header.existing_unpaid_donation', a_donation=((' href="/account/donations/' + existing_unpaid_donation_id + '"') | safe)) }}</div>
      {% endif %}
      <div>{{ gettext('page.donate.header.existing_unpaid_donation_view_all', a_all_donations=(' href="/account/donations/"' | safe)) }}</div>
    </div>
  {% endif %}

  <h2 class="mt-4 mb-4 text-3xl font-bold">{{ gettext('page.donate.title') }}</h2>

  <p class="mb-4">
    {{ gettext('page.donate.header.text1') }} {{ gettext('page.donate.header.text2') }}
  </p>

  <div class="js-membership-section-tier">
    <div class="flex flex-wrap justify-between md:overflow-hidden">
      <div class="md:min-w-[170px] w-[calc(50%-6px)] md:w-[21%] px-2 py-4 bg-white border border-gray-200 aria-selected:border-[#09008e] rounded-lg shadow mb-3 js-membership-tier js-membership-tier-2" aria-selected="false">
        <div class="js-membership-name-tier whitespace-nowrap text-center mb-2"></div>
        <div class="js-membership-cost-tier text-center font-bold text-xl mb-2"></div>
        <button onclick="window.membershipTierToggle('2')" class="text-center mb-1 block bg-[#0095ff] hover:bg-[#007ed8] [[aria-selected=true]_&]:bg-[#09008e] px-2 py-1 rounded-md text-white w-[100%]">
          <span class="[[aria-selected=true]_&]:hidden">{{ gettext('page.donate.buttons.join') }}</span>
          <span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> {{ gettext('page.donate.buttons.selected') }}</span>
        </button>
        <div class="text-xs text-gray-500 text-center mb-4">{{ gettext('page.donate.buttons.up_to_discounts', percentage=25) }}</div>
        <ul class="pl-[20px]">
          <li class="relative mb-1"><span class="icon-[ion--checkmark-outline] absolute top-[4px] left-[-20px]"></span> 🚀 {{ gettext('page.donate.perks.fast_downloads', number=(('<strong>' + (MEMBERSHIP_DOWNLOADS_PER_DAY['2'] | string) + '</strong>') | safe)) }}</li>
          <li class="relative mb-1"><span class="icon-[ion--checkmark-outline] absolute top-[4px] left-[-20px]"></span> 🧬 SciDB papers <strong>unlimited</strong> without verification</li>
          <!-- <li class="relative mb-1"><span class="icon-[ion--checkmark-outline] absolute top-[4px] left-[-20px]"></span> {{ gettext('page.donate.perks.credits') }}</li> -->
        </ul>
      </div>
      <div class="md:min-w-[180px] w-[calc(50%-6px)] md:w-[21%] px-2 py-4 bg-white border border-gray-200 aria-selected:border-[#09008e] rounded-lg shadow mb-3 js-membership-tier js-membership-tier-3" aria-selected="false">
        <div class="js-membership-name-tier whitespace-nowrap text-center mb-2"></div>
        <div class="js-membership-cost-tier text-center font-bold text-xl mb-2"></div>
        <button onclick="window.membershipTierToggle('3')" class="text-center mb-1 block bg-[#0095ff] hover:bg-[#007ed8] [[aria-selected=true]_&]:bg-[#09008e] px-2 py-1 rounded-md text-white w-[100%]">
          <span class="[[aria-selected=true]_&]:hidden">{{ gettext('page.donate.buttons.join') }}</span>
          <span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> {{ gettext('page.donate.buttons.selected') }}</span>
        </button>
        <div class="text-xs text-gray-500 text-center mb-4">{{ gettext('page.donate.buttons.up_to_discounts', percentage=25) }}</div>
        <ul class="pl-[20px]">
          <li class="text-sm relative mb-1">{{ gettext('page.donate.perks.previous_plus') }}</li>
          <li class="relative mb-1"><span class="icon-[ion--checkmark-outline] absolute top-[4px] left-[-20px]"></span> 🚀 {{ gettext('page.donate.perks.fast_downloads', number=(('<strong>' + (MEMBERSHIP_DOWNLOADS_PER_DAY['3'] | string) + '</strong>') | safe)) }}</li>
          <!-- <li class="relative mb-1"><span class="icon-[ion--checkmark-outline] absolute top-[4px] left-[-20px]"></span> {{ gettext('page.donate.perks.early_access') }}</li> -->
        </ul>
      </div>
      <div class="md:min-w-[180px] w-[calc(50%-6px)] md:w-[23%] px-2 py-4 bg-white border border-gray-200 aria-selected:border-[#09008e] rounded-lg shadow mb-3 js-membership-tier js-membership-tier-4" aria-selected="false">
        <div class="js-membership-name-tier whitespace-nowrap text-center mb-2"></div>
        <div class="js-membership-cost-tier text-center font-bold text-xl mb-2"></div>
        <button onclick="window.membershipTierToggle('4')" class="text-center mb-1 block bg-[#0095ff] hover:bg-[#007ed8] [[aria-selected=true]_&]:bg-[#09008e] px-2 py-1 rounded-md text-white w-[100%]">
          <span class="[[aria-selected=true]_&]:hidden">{{ gettext('page.donate.buttons.join') }}</span>
          <span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> {{ gettext('page.donate.buttons.selected') }}</span>
        </button>
        <div class="text-xs text-gray-500 text-center mb-4">{{ gettext('page.donate.buttons.up_to_discounts', percentage=25) }}</div>
        <ul class="pl-[20px]">
          <li class="text-sm relative mb-1">{{ gettext('page.donate.perks.previous_plus') }}</li>
          <li class="relative mb-1"><span class="icon-[ion--checkmark-outline] absolute top-[4px] left-[-20px]"></span> 🚀 {{ gettext('page.donate.perks.fast_downloads', number=(('<strong>' + (MEMBERSHIP_DOWNLOADS_PER_DAY['4'] | string) + '</strong>') | safe)) }}</li>
          <li class="relative mb-1"><span class="icon-[ion--checkmark-outline] absolute top-[4px] left-[-20px]"></span> 😼 {{ gettext('page.donate.perks.exclusive_telegram') }}</li>
        </ul>
      </div>
      <div class="md:min-w-[240px] w-[calc(50%-6px)] md:w-[29%] px-2 py-4 bg-white border border-gray-200 aria-selected:border-[#09008e] rounded-lg shadow mb-3 js-membership-tier js-membership-tier-5" aria-selected="false">
        <div class="js-membership-name-tier whitespace-nowrap text-center mb-2"></div>
        <div class="js-membership-cost-tier text-center font-bold text-xl mb-2"></div>
        <button onclick="window.membershipTierToggle('5')" class="text-center mb-1 block bg-[#0095ff] hover:bg-[#007ed8] [[aria-selected=true]_&]:bg-[#09008e] px-2 py-1 rounded-md text-white w-[100%]">
          <span class="[[aria-selected=true]_&]:hidden">{{ gettext('page.donate.buttons.join') }}</span>
          <span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> {{ gettext('page.donate.buttons.selected') }}</span>
        </button>
        <div class="text-xs text-gray-500 text-center mb-4">{{ gettext('page.donate.buttons.up_to_discounts', percentage=25) }}</div>
        <ul class="pl-[20px]">
          <li class="text-sm relative mb-1">{{ gettext('page.donate.perks.previous_plus') }}</li>
          <li class="relative mb-1"><span class="icon-[ion--checkmark-outline] absolute top-[4px] left-[-20px]"></span> 🚀 {{ gettext('page.donate.perks.fast_downloads', number=(('<strong>' + (MEMBERSHIP_DOWNLOADS_PER_DAY['5'] | string) + '</strong>') | safe)) }}</li>
          <li class="relative mb-1"><span class="icon-[ion--checkmark-outline] absolute top-[4px] left-[-20px]"></span> 🤗 {{ gettext('page.donate.perks.adopt', div_months=(' class="text-gray-500 text-sm" ' | safe)) }}</li>
        </ul>
      </div>
    </div>

    <p class="mb-4 text-sm text-gray-500">
      {{ gettext('page.donate.header.large_donations') }}
    </p>
  </div>

  <div class="hidden js-membership-section-method">
    <p class="mt-8 mb-4">
      <!-- {{ gettext('page.donate.payment.intro', bitcoin_icon=('<span class="hidden icon-[mdi--bitcoin] text-xl align-text-bottom text-gray-500"></span>' | safe)) }} -->
      <!-- {{ gettext('page.donate.payment.intro2', bitcoin_icon=('<span class="hidden icon-[mdi--bitcoin] text-xl align-text-bottom text-gray-500"></span>' | safe)) }} -->
      <!-- Select a payment option. We mostly have crypto-based payments <span class="icon-[mdi--bitcoin] text-xl align-text-bottom text-gray-500"></span>, since traditional payment processors don't like to work with us. -->
      Please select a payment method.
    </p>

    <div class="mb-4 flex flex-wrap items-end">
      <button class="js-membership-method js-membership-method-payment2 relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white mr-1" aria-selected="false" onclick="window.membershipMethodToggle('payment2')"><span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>{{ gettext('page.donate.payment.buttons.crypto', bitcoin_icon=('<span class="hidden icon-[mdi--bitcoin] text-lg align-text-bottom"></span>' | safe)) }}<span class="hidden absolute left-[50%] top-[-14px] translate-x-[-50%] bg-[#0095ff] text-white text-xs font-medium px-1 py-0.5 rounded">{{ gettext('page.donate.discount', percentage=20) }}</span></button>
      <!-- <button class="js-membership-method js-membership-method-cc     relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white mr-1" aria-selected="false" onclick="window.membershipMethodToggle('cc')"><span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>Credit/debit card <span class="hidden icon-[mdi--bitcoin] text-lg align-text-bottom"></span><span class="hidden absolute left-[50%] top-[-14px] translate-x-[-50%] bg-[#0095ff] text-white text-xs font-medium px-1 py-0.5 rounded">{{ gettext('page.donate.discount', percentage=20) }}</span></button> -->
      <!-- <button class="js-membership-method js-membership-method-paypal relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white mr-1" aria-selected="false" onclick="window.membershipMethodToggle('paypal')"><span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>{{ gettext('page.donate.payment.buttons.paypal', bitcoin_icon=('<span class="hidden icon-[mdi--bitcoin] text-lg align-text-bottom"></span>' | safe)) }}<span class="hidden absolute left-[50%] top-[-14px] translate-x-[-50%] bg-[#0095ff] text-white text-xs font-medium px-1 py-0.5 rounded">{{ gettext('page.donate.discount', percentage=20) }}</span></button> -->
      <!-- <button class="js-membership-method js-membership-method-paypalreg relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white mr-1" aria-selected="false" onclick="window.membershipMethodToggle('paypalreg')"><span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>PayPal (regular)</button> -->
      <!-- <button class="js-membership-method js-membership-method-givebutter relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white mr-1" aria-selected="false" onclick="window.membershipMethodToggle('givebutter')"><span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>Card / PayPal / Venmo</button> -->
      <button class="js-membership-method js-membership-method-amazon relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white mr-1" aria-selected="false" onclick="window.membershipMethodToggle('amazon')"><span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>Amazon Gift Card</button>
      <button class="js-membership-method js-membership-method-hoodpay relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white mr-1" aria-selected="false" onclick="window.membershipMethodToggle('hoodpay')"><span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>Credit/debit card</button>
      <!-- <button class="js-membership-method js-membership-method-bmc    relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white mr-1"           aria-selected="false" onclick="window.membershipMethodToggle('bmc')"><span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>Credit/debit/Apple/Google (BMC <span class="icon-[ph--coffee-fill] text-lg align-text-bottom"></span>)</button> -->
      <!-- <button class="js-membership-method js-membership-method-alipay relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white mr-1"           aria-selected="false" onclick="window.membershipMethodToggle('alipay')"><span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>{{ gettext('page.donate.payment.buttons.alipay') }}</button> -->
      <!-- <button class="js-membership-method js-membership-method-pix    relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white mr-1"           aria-selected="false" onclick="window.membershipMethodToggle('pix')"><span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>{{ gettext('page.donate.payment.buttons.pix') }}</button> -->
      <!-- <button class="js-membership-method js-membership-method-crypto relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white mr-1" aria-selected="false" onclick="window.membershipMethodToggle('crypto')"><span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>{{ gettext('page.donate.payment.buttons.crypto', bitcoin_icon=('<span class="hidden icon-[mdi--bitcoin] text-lg align-text-bottom"></span>' | safe)) }}<span class="hidden absolute left-[50%] top-[-14px] translate-x-[-50%] bg-[#0095ff] text-white text-xs font-medium px-1 py-0.5 rounded">{{ gettext('page.donate.discount', percentage=20) }}</span></button> -->
      <!-- <button class="js-membership-method js-membership-method-paypal relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white mr-1" aria-selected="false" onclick="window.membershipMethodToggle('paypal')"><span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>PayPal <span class="hidden icon-[mdi--bitcoin] text-lg align-text-bottom"></span><span class="hidden absolute left-[50%] top-[-14px] translate-x-[-50%] bg-[#0095ff] text-white text-xs font-medium px-1 py-0.5 rounded">{{ gettext('page.donate.discount', percentage=20) }}</span></button> -->
      <button class="js-membership-method js-membership-method-payment2paypal relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white mr-1" aria-selected="false" onclick="window.membershipMethodToggle('payment2paypal')"><span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>PayPal <span class="hidden icon-[mdi--bitcoin] text-lg align-text-bottom"></span><span class="hidden absolute left-[50%] top-[-14px] translate-x-[-50%] bg-[#0095ff] text-white text-xs font-medium px-1 py-0.5 rounded">{{ gettext('page.donate.discount', percentage=20) }}</span></button>
      <button class="js-membership-method js-membership-method-payment2cashapp relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white mr-1" aria-selected="false" onclick="window.membershipMethodToggle('payment2cashapp')"><span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>Cash App <span class="hidden icon-[mdi--bitcoin] text-lg align-text-bottom"></span><span class="hidden absolute left-[50%] top-[-14px] translate-x-[-50%] bg-[#0095ff] text-white text-xs font-medium px-1 py-0.5 rounded">{{ gettext('page.donate.discount', percentage=20) }}</span></button>
      <button class="js-membership-method js-membership-method-payment2cc relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white mr-1" aria-selected="false" onclick="window.membershipMethodToggle('payment2cc')"><span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>Credit/debit card 2 <span class="hidden icon-[mdi--bitcoin] text-lg align-text-bottom"></span><span class="hidden absolute left-[50%] top-[-14px] translate-x-[-50%] bg-[#0095ff] text-white text-xs font-medium px-1 py-0.5 rounded">{{ gettext('page.donate.discount', percentage=20) }}</span></button>
      <!-- <button class="js-membership-method js-membership-method-binance relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white mr-1" aria-selected="false" onclick="window.membershipMethodToggle('binance')"><span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>Credit/debit card or bank <span class="hidden icon-[mdi--bitcoin] text-lg align-text-bottom"></span><span class="hidden absolute left-[50%] top-[-14px] translate-x-[-50%] bg-[#0095ff] text-white text-xs font-medium px-1 py-0.5 rounded">{{ gettext('page.donate.discount', percentage=20) }}</span></button> -->
      <!-- <button class="js-membership-method js-membership-method-payment1 relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white mr-1 {% if g.domain_lang_code == 'zh' %}order-[-1]{% endif %}" aria-selected="false" onclick="window.membershipMethodToggle('payment1')"><span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>Alipay 支付宝 / WeChat 微信</button> -->
      <button class="text-gray-500 relative mb-1 bg-gray-300 px-2 py-1 rounded-md mr-1 {% if g.domain_lang_code == 'zh' %}order-[-1]{% endif %}" aria-selected="false"><span class="[[aria-selected=false]_&]:hidden"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>Alipay 支付宝 / WeChat 微信 (temporarily unavailable)</button>
    </div>
  </div>

  <div class="hidden js-membership-section-duration">
    <div class="js-membership-descr js-membership-descr-crypto">
      <p class="mb-4">
        {{ gettext('page.donate.payment.desc.crypto') }}
      </p>
    </div>

    <div class="js-membership-descr js-membership-descr-payment2">
      <p class="mb-4">
        With crypto you can donate using BTC, ETH, XMR, and more.
      </p>

      <p class="mb-4">
        If you’re using crypto for the first time, we suggest using <a href="https://www.binance.com/en" rel="noopener noreferrer nofollow" target="_blank">Binance</a>, <a href="https://www.coinbase.com" rel="noopener noreferrer nofollow" target="_blank">Coinbase</a>, or <a href="https://www.kraken.com" rel="noopener noreferrer nofollow" target="_blank">Kraken</a> to buy and donate Bitcoin (the original and most used cryptocurrency).
      </p>
    </div>

    <div class="js-membership-descr js-membership-descr-paypal js-membership-descr-payment2paypal">
      <p class="mb-4">
        <!-- {{ gettext('page.donate.payment.desc.paypal') }} -->
        Donate using PayPal.
      </p>
    </div>

    <div class="js-membership-descr js-membership-descr-paypal js-membership-descr-payment2cashapp">
      <p class="mb-4">
        Donate using Cash App. If you have Cash App, this the easiest way to donate!
      </p>
      <p class="mb-4">
        Note that for transactions under $25, Cash App may charge a $2-4 fee. For $25 or above, it’s free!
      </p>
    </div>

    <div class="js-membership-descr js-membership-descr-payment2cc">
      <p class="mb-4">
        Donate using credit/debit card. Google Pay and Apple Pay might also work.
        <!-- Note that for small donations the credit card fees may eliminate our 20% discount, so we recommend longer subscriptions. -->
        Note that for small donations the fees are high, so we recommend longer subscriptions.
      </p>
    </div>

    <div class="js-membership-descr js-membership-descr-binance">
      <p class="mb-4">
        With Binance, you buy Bitcoin with a credit/debit card or bank account, and then donate that Bitcoin to us. That way we can remain secure and anonymous when accepting your donation.
      </p>

      <p class="mb-4">
        Binance is available in almost every country, and supports most banks and credit/debit cards. This is currently our main recommendation. We appreciate you taking the time to learn how to donate using this method, since it helps us out a lot.
      </p>
    </div>

    <div class="js-membership-descr js-membership-descr-paypalreg">
      <p class="mb-4">
        Donate using your regular PayPal account.
      </p>
    </div>

    <div class="js-membership-descr js-membership-descr-payment1">
      <p class="mb-4">
        Donate using Alipay or WeChat. You can choose between these on the next page.
      </p>
    </div>

    <div class="js-membership-descr js-membership-descr-givebutter">
      <p class="mb-4">
        Donate using credit/debit card, PayPal, or Venmo. You can choose between these on the next page.
      </p>
    </div>

    <div class="js-membership-descr js-membership-descr-amazon">
      <p class="mb-4">
        Donate using an Amazon gift card. Note that we need to round to amounts accepted by our resellers (minimum $10).
      </p>

      <p class="mb-4">
        <strong>IMPORTANT:</strong> We only support Amazon.com, not other Amazon websites. For example, .de, .co.uk, .ca, are NOT supported.
      </p>
    </div>

    <div class="js-membership-descr js-membership-descr-hoodpay">
      <p class="mb-4">
        Donate with a credit or debit card.
      </p>
    </div>

    <!-- <div class="js-membership-descr js-membership-descr-bmc">
      <p class="mb-4">
        For credit cards, debit cards, Apple Pay, and Google Pay, we use “Buy Me a Coffee” (BMC <span class="icon-[ph--coffee-fill] text-lg align-text-bottom"></span>). In their system, one “coffee” is equal to $5, so your donation will be rounded to the nearest multiple of 5.
      </p>
    </div> -->

    <p class="mb-4">
      {{ gettext('page.donate.duration.intro') }}
    </p>

    <div class="flex">
      <div class="flex flex-col whitespace-nowrap">
        <button class="js-membership-duration js-membership-duration-1 relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white pl-3 mr-[32px]" aria-selected="false" onclick="window.membershipDurationToggle('1')"><span class="[[aria-selected=false]_&]:invisible"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>{{ gettext('page.donate.duration.1_mo') }}<span class="invisible"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span></span></button>
        <button class="js-membership-duration js-membership-duration-3 relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white pl-3 mr-[32px]" aria-selected="false" onclick="window.membershipDurationToggle('3')"><span class="[[aria-selected=false]_&]:invisible"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>{{ gettext('page.donate.duration.3_mo') }}<span class="invisible"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span></span> <span class="absolute right-[16px] top-[50%] translate-x-[100%] translate-y-[-50%] bg-[#0095ff] text-white text-xs font-medium px-1 py-0.5 rounded">{{ gettext('page.donate.discount', percentage=5) }}</span></button>
        <button class="js-membership-duration js-membership-duration-6 relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white pl-3 mr-[32px]" aria-selected="false" onclick="window.membershipDurationToggle('6')"><span class="[[aria-selected=false]_&]:invisible"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>{{ gettext('page.donate.duration.6_mo') }}<span class="invisible"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span></span> <span class="absolute right-[16px] top-[50%] translate-x-[100%] translate-y-[-50%] bg-[#0095ff] text-white text-xs font-medium px-1 py-0.5 rounded">{{ gettext('page.donate.discount', percentage=10) }}</span></button>
        <button class="js-membership-duration js-membership-duration-12 relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white pl-3 mr-[32px]" aria-selected="false" onclick="window.membershipDurationToggle('12')"><span class="[[aria-selected=false]_&]:invisible"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>{{ gettext('page.donate.duration.12_mo') }}<span class="invisible"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span></span> <span class="absolute right-[16px] top-[50%] translate-x-[100%] translate-y-[-50%] bg-[#0095ff] text-white text-xs font-medium px-1 py-0.5 rounded">{{ gettext('page.donate.discount', percentage=15) }}</span></button>
        <button class="js-membership-duration js-membership-duration-24 relative mb-1 bg-gray-500 hover:bg-gray-600 aria-selected:bg-[#09008e] px-2 py-1 rounded-md text-white pl-3 mr-[32px]" aria-selected="false" onclick="window.membershipDurationToggle('24')"><span class="[[aria-selected=false]_&]:invisible"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span> </span>{{ gettext('page.donate.duration.24_mo') }}<span class="invisible"><span class="icon-[ion--checkmark-circle-sharp] text-lg align-text-bottom"></span></span> <span class="absolute right-[16px] top-[50%] translate-x-[100%] translate-y-[-50%] bg-[#0095ff] text-white text-xs font-medium px-1 py-0.5 rounded">{{ gettext('page.donate.discount', percentage=25) }}</span></button>
      </div>
      <div class="flex flex-col justify-center w-[100%] max-w-[350px] text-center">
        {{ gettext('page.donate.duration.summary', div_monthly_cost=(' class="text-2xl font-bold js-membership-monthly-cost"' | safe), div_after=(' class="text-sm text-gray-500 font-[300] mb-4"' | safe), span_discount=(' class="font-[800] js-membership-discount-percentage"' | safe), div_total=(' class="text-2xl font-bold js-membership-total-cost"' | safe), div_duration=(' class="text-sm text-gray-500 font-[300] js-membership-total-duration"' | safe)) }}
      </div>
    </div>

    <form onsubmit="window.submitForm(event, '/dyn/account/buy_membership/', (data) => { if (data.error) { alert(data.error); location.reload() } else { window.location = data.redirect_url } })" class="js-membership-form mt-4 mb-4">
      <fieldset class="mb-2">
        <div class="js-membership-donate-minimum mb-4 hidden"></div>
        <div class="js-membership-donate-maximum mb-4 hidden"></div>

        <div class="js-membership-donate-submit-confirmation">
          <div class="[html.aa-logged-in_&]:hidden">
            <p class="mb-4">
              {{ gettext('page.donate.login2', a_login=(' href="/login" ' | safe)) }}
            </p>
          </div>

          <div class="[html:not(.aa-logged-in)_&]:hidden">
            <div class="js-membership-descr js-membership-descr-payment2">
              <p class="mb-4">
                Select your preferred crypto coin:
              </p>

              <!-- Be sure to update the validation list in `def buy_membership`! -->
              <select class="pr-8 mb-4 bg-[#00000011] px-2 py-1 rounded" name="pay_currency">
                <option value="btc">BTC / Bitcoin</option>
                <option value="eth">ETH / Ethereum</option>
                <option value="bch">BCH / Bitcoin Cash</option>
                <option value="ltc">LTC / Litecoin</option>
                <option value="xmr">XMR / Monero</option>
                <option value="ada">ADA / Cardano</option>
                <option value="bnbbsc">BNB BSC / Binance Coin</option>
                <option value="busdbsc">BUSD BSC / Binance USD</option>
                <option value="dai">DAI</option>
                <option value="doge">DOGE / Dogecoin</option>
                <option value="dot">DOT / Polkadot</option>
                <option value="matic">MATIC / Polygon</option>
                <option value="near">NEAR</option>
                <option value="pax">PAX / Paxos</option>
                <option value="pyusd">PYUSD / PayPal USD</option>
                <option value="sol">SOL / Solana</option>
                <option value="ton">TON / Toncoin</option>
                <option value="trx">TRX / Tron</option>
                <option value="tusd">TUSD / TrueUSD</option>
                <option value="usdc">USDC</option>
                <option value="usdterc20">USDT-ERC20 / Tether-Ethereum</option>
                <option value="usdttrc20">USDT-TRC20 / Tether-Tron</option>
                <option value="xrp">XRP / Ripple</option>
              </select>
            </div>

            <p class="mb-4">
              {{ gettext('page.donate.submit.confirm') }}
            </p>

            <input type="hidden" name="tier" value="">
            <input type="hidden" name="method" value="">
            <input type="hidden" name="duration" value="">
            <input type="hidden" name="costCentsUsdVerification" value="">
            <button type="submit" class="bg-[#0095ff] hover:bg-[#007ed8] px-4 py-1 rounded-md text-white mb-1">
              {{ gettext('page.donate.submit.button', span_cost=(' class="font-bold js-membership-donate-button-cost"' | safe), span_label=(' class="text-xs js-membership-donate-button-label"' | safe)) }}
            </button>
            <span class="js-spinner invisible mb-[-3px] text-xl text-[#555] inline-block icon-[svg-spinners--ring-resize]"></span>

            <p class="text-xs text-gray-500">
              {{ gettext('page.donate.submit.cancel_note') }}
            </p>
          </div>
        </fieldset>
        <div class="hidden js-success">{{ gettext('page.donate.submit.success') }}</div>
        <div class="hidden js-failure">{{ gettext('page.donate.submit.failure') }}</div>
      </div>
    </form>
  </div>

  <script>
    (function() {
      const membershipTierNames = {{ membership_tier_names | tojson }};
      const MEMBERSHIP_TIER_COSTS = {{ MEMBERSHIP_TIER_COSTS | tojson }};
      const MEMBERSHIP_METHOD_DISCOUNTS = {{ MEMBERSHIP_METHOD_DISCOUNTS | tojson }};
      const MEMBERSHIP_DURATION_DISCOUNTS = {{ MEMBERSHIP_DURATION_DISCOUNTS | tojson }};
      const MEMBERSHIP_METHOD_MINIMUM_CENTS_USD = {{ MEMBERSHIP_METHOD_MINIMUM_CENTS_USD | tojson }};
      const MEMBERSHIP_METHOD_MAXIMUM_CENTS_NATIVE = {{ MEMBERSHIP_METHOD_MAXIMUM_CENTS_NATIVE | tojson }};
      const membershipCostsData = {{ membership_costs_data | tojson }};

      function getMembershipParams() {
        return Object.fromEntries(new URLSearchParams(location.search));
      }

      function updatePageFromUrl() {
        document.querySelectorAll('.js-membership-tier, .js-membership-method, .js-membership-duration').forEach((el) => el.setAttribute('aria-selected', 'false'));
        document.querySelectorAll('.js-membership-section-method, .js-membership-section-duration, .js-membership-descr, .js-membership-section-one-time').forEach((el) => el.classList.add("hidden"));

        const membershipParams = getMembershipParams();
        // console.log("updatePageFromUrl", membershipParams);

        let cost = 0;
        let duration = 1;
        if (Object.keys(MEMBERSHIP_TIER_COSTS).includes(membershipParams.tier)) {
          cost = MEMBERSHIP_TIER_COSTS[membershipParams.tier];
          document.querySelector(`.js-membership-tier-${membershipParams.tier}`).setAttribute('aria-selected', 'true');
          document.querySelector('.js-membership-section-method').classList.remove("hidden");
        }

        if (Object.keys(MEMBERSHIP_METHOD_DISCOUNTS).includes(membershipParams.method)) {
          document.querySelectorAll(`.js-membership-method-${membershipParams.method}`).forEach(el => el.setAttribute('aria-selected', 'true'));
          document.querySelectorAll(`.js-membership-descr-${membershipParams.method}`).forEach(el => el.classList.remove("hidden"));
          if (Object.keys(MEMBERSHIP_TIER_COSTS).includes(membershipParams.tier)) {
            document.querySelector('.js-membership-section-duration').classList.remove("hidden");
          }
        }

        if (Object.keys(MEMBERSHIP_DURATION_DISCOUNTS).includes(membershipParams.duration)) {
          duration = parseInt(membershipParams.duration);
          document.querySelector(`.js-membership-duration-${membershipParams.duration}`).setAttribute('aria-selected', 'true');
        } else {
          document.querySelector('.js-membership-duration-1').setAttribute('aria-selected', 'true');
        }

        for (const tier of Object.keys(MEMBERSHIP_TIER_COSTS)) {
          document.querySelector(`.js-membership-tier-${tier} .js-membership-name-tier`).innerHTML = membershipTierNames[tier].replace(' ', '<br>');
          document.querySelector(`.js-membership-tier-${tier} .js-membership-cost-tier`).innerText = `\$${MEMBERSHIP_TIER_COSTS[tier]} / month`;
        }

        const membershipParamsStr = [membershipParams.tier, membershipParams.method, membershipParams.duration || "1"].join(',');
        const costsData = membershipCostsData[membershipParamsStr];
        if (costsData) {
          document.querySelector('.js-membership-discount-percentage').innerText = `{{ gettext('page.donate.duration.summary.discount', percentage=('${costsData.discounts}' | safe)) }}`;
          document.querySelector('.js-membership-monthly-cost').innerText = `{{ gettext('page.donate.duration.summary.monthly_cost', monthly_cost=('${costsData.monthly_cents_str}' | safe)) }}`;
          document.querySelector('.js-membership-total-cost').innerText = costsData.cost_cents_native_currency_str_calculator;
          document.querySelector('.js-membership-total-duration').innerText = {
            '1': `{{ gettext('page.donate.duration.summary.duration.1_mo') }}`,
            '3': `{{ gettext('page.donate.duration.summary.duration.3_mo') }}`,
            '6': `{{ gettext('page.donate.duration.summary.duration.6_mo') }}`,
            '12': `{{ gettext('page.donate.duration.summary.duration.12_mo') }}`,
            '24': `{{ gettext('page.donate.duration.summary.duration.24_mo') }}`,
          }[costsData.duration];
          document.querySelector('.js-membership-donate-button-cost').innerText = costsData.cost_cents_native_currency_str_button;
          document.querySelector('.js-membership-donate-button-label').innerText = {
            '1': `{{ gettext('page.donate.submit.button.label.1_mo', tier_name=('${costsData.tier_name}' | safe)) }}`,
            '3': `{{ gettext('page.donate.submit.button.label.3_mo', tier_name=('${costsData.tier_name}' | safe)) }}`,
            '6': `{{ gettext('page.donate.submit.button.label.6_mo', tier_name=('${costsData.tier_name}' | safe)) }}`,
            '12': `{{ gettext('page.donate.submit.button.label.12_mo', tier_name=('${costsData.tier_name}' | safe)) }}`,
            '24': `{{ gettext('page.donate.submit.button.label.24_mo', tier_name=('${costsData.tier_name}' | safe)) }}`,
          }[costsData.duration];
          document.querySelector('.js-membership-form [name=costCentsUsdVerification]').value = costsData.cost_cents_usd;

          // We might override this below.
          document.querySelector(".js-membership-donate-submit-confirmation").classList.remove("hidden");

          const minimumCents = MEMBERSHIP_METHOD_MINIMUM_CENTS_USD[membershipParams.method];
          const minimumEl = document.querySelector('.js-membership-donate-minimum');
          if (costsData.cost_cents_usd < minimumCents) {
            minimumEl.classList.remove('hidden')
            minimumEl.innerText = "This payment method requires a minimum of $" + Math.floor(minimumCents/100) + " USD. Please select a different duration or payment method."
            document.querySelector(".js-membership-donate-submit-confirmation").classList.add("hidden");
          } else {
            minimumEl.classList.add('hidden')
          }

          const maximumCentsNative = MEMBERSHIP_METHOD_MAXIMUM_CENTS_NATIVE[membershipParams.method];
          const maximumEl = document.querySelector('.js-membership-donate-maximum');
          if (maximumCentsNative && costsData.cost_cents_native_currency > maximumCentsNative) {
            maximumEl.classList.remove('hidden')
            maximumEl.innerText = "This payment method only allows for a maximum of " + Math.floor(maximumCentsNative/100) + " " + costsData.native_currency_code + ". Please select a different duration or payment method."
            document.querySelector(".js-membership-donate-submit-confirmation").classList.add("hidden");
          } else {
            maximumEl.classList.add('hidden')
          }
        }

        document.querySelector('.js-membership-form [name=tier]').value = membershipParams.tier;
        document.querySelector('.js-membership-form [name=method]').value = membershipParams.method;
        document.querySelector('.js-membership-form [name=duration]').value = membershipParams.duration || 1;
      }

      window.addEventListener("popstate", updatePageFromUrl);
      window.addEventListener("DOMContentLoaded", updatePageFromUrl);
      updatePageFromUrl();

      window.membershipTierToggle = function(tierStr) {
        const membershipParams = getMembershipParams();
        if (membershipParams.tier === tierStr) {
          delete membershipParams.tier;
        } else {
          membershipParams.tier = tierStr;
          setTimeout(() => {
            window.scrollBy({ top: document.querySelector('.js-membership-section-tier').clientHeight, behavior: 'smooth' });
          });
        }
        window.history.replaceState(null, "", "?" + new URLSearchParams(membershipParams).toString());
        updatePageFromUrl();
      }
      window.membershipMethodToggle = function(methodStr) {
        const membershipParams = getMembershipParams();
        if (membershipParams.method === methodStr) {
          delete membershipParams.method;
        } else {
          membershipParams.method = methodStr;
        }
        window.history.replaceState(null, "", "?" + new URLSearchParams(membershipParams).toString());
        updatePageFromUrl();
      }
      window.membershipDurationToggle = function(durationStr) {
        const membershipParams = getMembershipParams();
        if (durationStr === "1") {
          delete membershipParams.duration;
        } else {
          membershipParams.duration = durationStr;
        }
        window.history.replaceState(null, "", "?" + new URLSearchParams(membershipParams).toString());
        updatePageFromUrl();
      }
    })();
  </script>
{% endblock %}
