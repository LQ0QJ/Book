{% extends "layouts/index.html" %}

{% block title %}{{ gettext('page.doi.title', doi_input=doi_input) }}{% endblock %}

{% block body %}
  <div class="mb-4">{{ gettext('page.doi.breadcrumbs', doi_input=doi_input) }}</div>

  {% if not(doi_dict is defined) %}
    <h2 class="mt-12 mb-1 text-3xl font-bold">{{ gettext('page.doi.invalid.header') }}</h2>
    <p class="mb-4 italic">
      {{ gettext('page.doi.invalid.text', doi_input=doi_input) }}
    </p>
  {% else %}
    <div class="mb-4 p-6 overflow-hidden bg-[#0000000d] break-words">
      <div class="text-xl font-bold mb-4">{{ gettext('page.doi.box.header', doi_input=doi_input) }}</div>

      <div class="mb-4">
        {{ gettext('page.doi.box.canonical_url', link=(('<a href="https://doi.org/' + doi_input + '">' + doi_input + '</a>') | safe)) }}
      </div>

      <div class="mb-4">
        {{ gettext('page.doi.box.scihub', link_open_tag=(('<a href="https://sci-hub.ru/' + doi_input + '">') | safe)) }}
      </div>

      {% if doi_dict.search_md5_dicts | length > 0 %}
        <p class="mb-2">
          {{ gettext('page.doi.results.text') }}
        </p>

        {% from 'macros/md5_list.html' import md5_list %}
        {{ md5_list(doi_dict.search_md5_dicts) }}
      {% else %}
        {{ gettext('page.doi.results.none') }}
      {% endif %}
    </div>

    <button class="custom bg-[#777] hover:bg-[#999] text-white font-bold py-1 px-3 rounded shadow mb-4 mt-8" onclick="document.querySelector('.js-technical-details').classList.remove('hidden'); this.classList.add('hidden')">{{ gettext('common.tech_details') }}</button>

    <div class="js-technical-details hidden">
      {% if gettext('common.english_only') != 'Text below continues in English.' %}
        <p class="mb-4 font-bold">{{ gettext('common.english_only') }}</p>
      {% endif %}

      <div lang="en">
        <h2 class="mt-12 mb-1 text-3xl font-bold">DOI</h2>

        <p class="mb-4">
          A <a href="https://en.wikipedia.org/wiki/Digital_object_identifier">digital object identifier (DOI)</a> is an identifier used to uniquely identify various objects, standardized by the International Organization for Standardization (ISO). DOIs are an implementation of the <a href="https://en.wikipedia.org/wiki/Handle_System">Handle System</a>, and within that system have the unique prefix of "10.". We currently don't have any DOI-specific metadata in our database, aside from records that have a DOI field.
        </p>

        <h2 class="mt-12 mb-1 text-3xl font-bold">Shadow library files</h2>

        <p class="mb-2">
          There are <strong>{{doi_dict.search_md5_dicts | length}}</strong> files found for which the metadata in one of the shadow libraries link to this ISBN. They are displayed at the top of this page.
        </p>

        <h2 class="mt-12 mb-1 text-3xl font-bold">Raw JSON</h2>

        <p class="mb-4">
          This is the raw JSON used to render this page.
        </p>

        <div class="text-xs p-4 font-mono break-words bg-[#0000000d]">{{ doi_dict_json | escape | replace('\n', '<br>' | safe) | replace('  ', '&nbsp;&nbsp;' | safe) }}</div>
      </div>
    </div>
  {% endif %}
{% endblock %}
