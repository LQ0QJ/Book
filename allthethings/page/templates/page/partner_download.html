{% extends "layouts/index.html" %}

{% block title %}{{ gettext('page.partner_download.header') }}{% endblock %}

{% block meta_tags %}
  <meta property="robots" content="noindex" />
{% endblock %}

{% block body %}
  <h2 class="mt-4 mb-4 text-3xl font-bold">{{ gettext('page.partner_download.header') }}</h2>

  {% if only_official %}
    <p class="mb-4 font-bold underline">
      {{ gettext('page.partner_download.slow_downloads_official', websites='annas-archive.org, .gs, or .se') }}
    </p>
  {% endif %}

  {% if no_cloudflare %}
    {{ gettext('page.partner_download.slow_downloads_cloudflare') }}
  {% endif %}

  <p class="mb-4">
    {{ gettext('page.partner_download.main_page', a_main=((' href="/md5/' + canonical_md5 + '"') | safe)) }}
  </p>

  {% if wait_seconds %}
    <p>
      <!-- TODO:TRANSLATE -->
      ‚è∞ In order to give everyone an opportunity to download files for free, you need to wait <strong>{{ wait_seconds }} seconds</strong> before you can download this file. 
    </p>
    <ul class="mb-4">
      <li>- Feel free to continue browsing Anna‚Äôs Archive in a different tab while waiting (if your browser supports refreshing background tabs).</li>
      <li>- Feel free to wait for multiple download pages to load at the same time (but please only download one file at the same time per server).</li>
      <li>- Once you get a download link it is valid for several hours.</li>
      <li>- Thanks for waiting, this keeps the website accessible for free for everyone! üòä</li>
      <li><label class="cursor-pointer"><input class="js-partner-reload mr-1" type="checkbox" maxlength="200"> Automatically refresh page. If you miss the download window, the timer restarts, so automatic refreshing is recommended.</label></li>
    </ul>
    <script>
      (function() {
        let partnerReload = false;
        let partnerTimeout = undefined;
        function setPartnerReload(newValue) {
          if (partnerReload === newValue) {
            return;
          }
          partnerReload = newValue;
          document.querySelector('.js-partner-reload').checked = partnerReload;
          if (partnerReload) {
            window.localStorage.partner_reload = "1";
            partnerTimeout = setTimeout(function() {
              window.location.reload();
            }, 5000);
          } else {
            window.localStorage.partner_reload = "0";
            clearTimeout(partnerTimeout);
          }
        }
        document.querySelector('.js-partner-reload').addEventListener('click', function(event) {
          setPartnerReload(event.target.checked);
        });

        if (window.localStorage.partner_reload !== "0" && window.localStorage.partner_reload !== "1") {
          window.localStorage.partner_reload = "1";
        }
        setPartnerReload(window.localStorage.partner_reload === "1");
      })();
    </script>
  {% endif %}

  {% if url %}
    <p class="mb-4">
      {{ gettext('page.partner_download.url', url=(('<a href="' + url + '" class="font-bold">' + gettext('page.partner_download.download_now') + '</a>') | safe), a_download=((' href="' + url + '" class="font-bold"') | safe)) }}
    </p>
  {% endif %}

  {% if warning %}
    <p class="mb-4 font-bold">
      ‚õîÔ∏è {{ gettext('page.partner_download.warning_many_downloads') }}
      <!-- {% if daily_download_count_from_ip %} {{ gettext('page.partner_download.downloads_last_24_hours', count=daily_download_count_from_ip) }}{% endif %} -->
      <!-- TODO:TRANSLATE -->
      If you‚Äôre using a VPN or shared internet connection, this warning this might be due to that.
    </p>
  {% endif %}

  {% if slow_download or only_official or no_cloudflare or wait_seconds %}
    <p class="mb-4">
      <!-- TODO:TRANSLATE -->
      <!-- üöÄ To get faster downloads, skip the browser checks, and skip waitlists, <a href="/donate">become a member</a>. -->
      {{ gettext('page.partner_download.faster_downloads', a_membership=(' href="/donate"' | safe)) }}
    </p>
  {% endif %}

  <p class="mb-4">
    {{ gettext('page.partner_download.bulk_mirroring', a_datasets=(' href="/datasets"' | safe), a_torrents=(' href="/torrents"' | safe)) }}
  </p>

  <!-- daily_download_count_from_ip: {{ daily_download_count_from_ip }} -->
{% endblock %}
